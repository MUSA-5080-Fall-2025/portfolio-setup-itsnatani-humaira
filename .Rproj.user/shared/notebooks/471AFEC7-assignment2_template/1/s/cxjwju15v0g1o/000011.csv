"0",""
"0","# Create points on surface for each school buffer"
"0","zone_points <- school_buffers %>%"
"0","  left_join(school_crime_counts, by = c(""school_nam"" = ""SCHOOL_NAME"")) %>%"
"0","  mutate("
"0","    geometry = st_point_on_surface(geometry)  # one point per buffer"
"0","  ) %>%"
"0","  st_as_sf()"
"0",""
"0","# Get tracts of Philly"
"0","tracts_phl <- get_acs("
"0","  geography = ""tract"","
"0","  state     = ""PA"","
"0","  county    = ""Philadelphia"","
"0","  variables = ""B01003_001"","
"0","  survey    = ""acs5"","
"0","  year      = 2022,"
"0","  geometry  = TRUE,"
"0","  cache_table = TRUE"
"0",") %>%"
"0","  select(GEOID, NAME, pop = estimate, geometry) %>%"
"0","  st_transform(2272)    "
"0",""
"0","# Map: crime counts by school zone"
"0","ggplot() +"
"0","  # base map: Philadelphia tracts"
"0","  geom_sf(data = tracts_phl, fill = NA, color = ""grey70"", linewidth = 0.2) +"
"0","  # school zone points sized by crime count"
"0","  geom_sf(data = zone_points, aes(size = crime_count), color = ""firebrick"", alpha = 0.6) +"
"0","  scale_size_continuous(name = ""Crime Count"", range = c(1, 6)) +"
"0","  labs("
"0","    title = ""Crime Counts Around School Zones"","
"0","    subtitle = ""Point size represents number of crimes within 500m (~1640 ft) of each school"","
"0","    x = NULL,"
"0","    y = NULL"
"0","  ) +"
"0","  theme_minimal(base_size = 13) +"
"0","  theme(legend.position = ""right"")"
