"0","# Get demographic data from ACS"
"0","vars <- c("
"0","  total_pop = ""B01003_001"","
"0","  med_income = ""B19013_001"","
"0","  male65_66 = ""B01001_020"","
"0","  male67_69 = ""B01001_021"","
"0","  male70_74 = ""B01001_022"","
"0","  male75_79 = ""B01001_023"","
"0","  male80_84 = ""B01001_024"","
"0","  male85plus = ""B01001_025"","
"0","  female65_66 = ""B01001_044"","
"0","  female67_69 = ""B01001_045"","
"0","  female70_74 = ""B01001_046"","
"0","  female75_79 = ""B01001_047"","
"0","  female80_84 = ""B01001_048"","
"0","  female85plus = ""B01001_049"""
"0",")"
"0",""
"0","# Pull data"
"0","pa_demo_data <- get_acs("
"0","  geography = ""tract"","
"0","  state = ""PA"","
"0","  variables = vars,"
"0","  survey = ""acs5"","
"0","  year = 2022,      # most recent ACS 5-year data"
"0","  geometry = TRUE   # include spatial geometries"
"0",")"
"0",""
"0","head(pa_demo_data)"
"1","Simple feature collection with 6 features and 5 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -77.03108 ymin: 39.79351 xmax: -76.99956 ymax: 39.81212"
"1","
"
"1","Geodetic CRS:  NAD83
"
"1"," "
"1","       GEOID"
"1","                                            NAME"
"1","   variable"
"1"," estimate"
"1"," moe"
"1","
1"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1","  male65_66"
"1","       56"
"1","  72"
"1","
2"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1","  male67_69"
"1","      145"
"1"," 128"
"1","
3"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1","  male70_74"
"1","       68"
"1","  48"
"1","
4"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1","  male75_79"
"1","       60"
"1","  41"
"1","
5"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1","  male80_84"
"1","       57"
"1","  52"
"1","
6"
"1"," 42001031101"
"1"," Census Tract 311.01; Adams County; Pennsylvania"
"1"," male85plus"
"1","       52"
"1","  41"
"1","
"
"1"," "
"1","                       geometry"
"1","
1"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
2"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
3"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
4"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
5"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
6"
"1"," MULTIPOLYGON (((-77.03108 3..."
"1","
"
"0","# Join to tract boundaries"
"0",""
"0","pa_tracts_demo <- pa_demo_data %>%"
"0","  select(GEOID, NAME, variable, estimate) %>%"
"0","  pivot_wider(names_from = variable, values_from = estimate) %>%"
"0","  mutate("
"0","    pop65plus = male65_66 + male67_69 + male70_74 + male75_79 +"
"0","                male80_84 + male85plus +"
"0","                female65_66 + female67_69 + female70_74 +"
"0","                female75_79 + female80_84 + female85plus"
"0","  )"
"0","pa_tracts_demo <- st_transform(pa_tracts_demo, st_crs(pa_counties))"
"0",""
"0","#count missing income data"
"0","sum(is.na(pa_tracts_demo$med_income))"
"1","[1]"
"1"," 63"
"1","
"
"0","#calculate median income across all PA census tracts"
"0","median_income_pa <- median(pa_tracts_demo$med_income, na.rm = TRUE)"
