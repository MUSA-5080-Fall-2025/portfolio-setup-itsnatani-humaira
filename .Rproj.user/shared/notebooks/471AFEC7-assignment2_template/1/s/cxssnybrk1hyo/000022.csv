"0","# Create and format priority counties table"
"0","# metrics for the priority: vulnerable index = normalized_number_of_vulnerable_tracts*0.3 + normalized_average_distant _hospital*0.5 + normalized_total_population*0.2"
"0",""
"0","scale_minmax <- function(x) {"
"0","  rng <- range(x, na.rm = TRUE)"
"0","  if (!is.finite(diff(rng)) || diff(rng) == 0) return(rep(0.5, length(x)))"
"0","  (x - rng[1]) / diff(rng)"
"0","}"
"0",""
"0","counties_stat_index <- counties_stat %>%"
"0","  mutate("
"0","    n_vuln_norm = scale_minmax(n_vuln),"
"0","    avg_dist_vuln_mi_norm = scale_minmax(avg_dist_vuln_mi),"
"0","    total_vuln_pop_norm = scale_minmax(total_vuln_pop),"
"0","    percentage_vuln_norm = scale_minmax(percentage_vuln)"
"0","  ) %>%"
"0","   mutate("
"0","     vuln_index ="
"0","       0.3  * n_vuln_norm +"
"0","       0.5 * avg_dist_vuln_mi_norm +"
"0","       0.2 * total_vuln_pop_norm"
"0","   ) %>%"
"0","  arrange(desc(vuln_index))"
"0",""
"0",""
"0","#make table"
"0",""
"0","library(knitr)"
"0",""
"0","counties_table <- counties_stat_index %>%"
"0","  select("
"0","    county_name = COUNTY_NAM,"
"0","    vulnerable_index = vuln_index,"
"0","    vulnerable_tract_number = n_vuln,"
"0","    average_dist_to_hospital = avg_dist_vuln_mi,"
"0","    total_vulnerable_pop = total_vuln_pop"
"0","  ) %>%"
"0","  mutate("
"0","    vulnerable_index = round(vulnerable_index, 3),"
"0","    average_dist_to_hospital = round(average_dist_to_hospital, 2),"
"0","    total_vulnerable_pop = comma(total_vulnerable_pop)"
"0","  )%>%"
"0","  arrange(desc(vulnerable_index))"
"0",""
"0","kable("
"0","  counties_table,"
"0","  caption = ""PA County-level Vulnerability Summary"","
"0","  align = ""lcccc"""
"0",")"
