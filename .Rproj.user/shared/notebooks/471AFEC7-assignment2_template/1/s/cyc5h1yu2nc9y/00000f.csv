"0","# Transform to appropriate projected CRS"
"0","vulnerable_tracts_proj <- vulnerable_tracts %>%"
"0","  st_transform(5070) # 5070 is a projected coordinate system appropriate for the US. For south PA alone, we can use 3365 too as an alternative, which is more precise."
"0",""
"0","hospitals_proj <- hospitals %>%"
"0","  st_transform(5070)"
"0",""
"0",""
"0","# Calculate distance from each tract centroid to nearest hospital"
"0",""
"0","tract_centroids <- st_centroid(vulnerable_tracts_proj)"
"0",""
"0","nearest_hospital_idx <- st_nearest_feature(tract_centroids, hospitals_proj)"
"0",""
"0","dist_to_hospital <- st_distance("
"0","  tract_centroids,"
"0","  hospitals_proj[nearest_hospital_idx, ],"
"0","  by_element = TRUE"
"0",")"
"0",""
"0",""
"0","vulnerable_tracts_proj <- vulnerable_tracts_proj %>%"
"0","  mutate("
"0","    dist_to_hospital = as.numeric(dist_to_hospital),"
"0","    dist_to_hospital_mi = dist_to_hospital * 0.000621371"
"0","  )"
"0",""
"0","distant_data <- vulnerable_tracts_proj %>%"
"0","  summarise("
"0","    avg_distance = mean(dist_to_hospital_mi, na.rm = TRUE),"
"0","    max_dist = max(dist_to_hospital_mi, na.rm = TRUE),"
"0","  )"
"0",""
"0",""
"0","num_over15 <- vulnerable_tracts_proj %>%"
"0","  filter(dist_to_hospital_mi > 15) %>%"
"0","  summarise("
"0","    n_over15 = n(),"
"0","  )"
"0",""
