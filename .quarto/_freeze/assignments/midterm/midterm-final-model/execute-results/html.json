{
  "hash": "a10bdec9de0d3ddefe0d0c276c9187bf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"MUSA 5080 Midterm\"\nsubtitle: \"Single-Family Home Price Prediction in Philadelphia\"\nauthor: \"Jed Chew\"\ndate: today\nformat: \n  html:\n    code-fold: false\n    toc: true\n    toc-location: left\n    theme: cosmo\n    embed-resources: true\nexecute:\n  warning: false\n  message: false\neditor: \n  markdown: \n    wrap: 80\n---\n\n## MUSA 5080 Midterm\n\n**Goal:** Predict 2023-2024 home sale prices accurately while communicating\nfindings clearly to a policy audience.\n\n\n\n## Part 1: Data Cleaning & Preparation\n\n### Primary Dataset: [Property Sales](https://metadata.phila.gov/#home/datasetdetails/5543865f20583086178c4ee5/representationdetails/55d624fdad35c7e854cb21a4/)\n\nThis dataset contains actual property sales with:\n\n-   Sale price\n-   Sale date\n-   Property characteristics (bedrooms, bathrooms, sq ft, etc.)\n-   Property location (address, coordinates)\n\n### Step 1: Load and clean Philadelphia sales data\n\n-   Clean it (missing values, outliers, data errors)\n-   Filter to 2023-2024 residential sales only\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_data <- read_csv(\"data/clean_data.csv\")\nhead(sales_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 51\n  sale_date           sale_price total_area total_livable_area year_built\n  <dttm>                   <dbl>      <dbl>              <dbl>      <dbl>\n1 2024-04-16 08:00:00      90000        644                900       1925\n2 2024-10-18 08:00:00      20000       1073                976       1940\n3 2023-09-17 08:00:00     389000       4701               1080       1961\n4 2023-08-01 08:00:00     309000       2050               1792       1925\n5 2023-07-31 08:00:00     185000       1125               1440       1925\n6 2024-06-30 08:00:00     399000       1984               2292       1925\n# ℹ 46 more variables: category_code <dbl>, category_code_description <chr>,\n#   census_tract <dbl>, exterior_condition <dbl>, interior_condition <dbl>,\n#   fireplaces <dbl>, garage_spaces <dbl>, general_construction <chr>,\n#   market_value <dbl>, number_of_bathrooms <dbl>, number_of_bedrooms <dbl>,\n#   basements <chr>, prop_id <dbl>, violent_2blocks <dbl>, petty_1block <dbl>,\n#   neigh_name <chr>, dist_stop_ft <dbl>, dist_bike_ft <dbl>,\n#   dist_hosp_mi <dbl>, service_band_code <dbl>, service_band <chr>, …\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(sales_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 19,736\nColumns: 51\n$ sale_date                 <dttm> 2024-04-16 08:00:00, 2024-10-18 08:00:00, 2…\n$ sale_price                <dbl> 90000, 20000, 389000, 309000, 185000, 399000…\n$ total_area                <dbl> 644, 1073, 4701, 2050, 1125, 1984, 1384, 111…\n$ total_livable_area        <dbl> 900, 976, 1080, 1792, 1440, 2292, 1188, 1845…\n$ year_built                <dbl> 1925, 1940, 1961, 1925, 1925, 1925, 1950, 19…\n$ category_code             <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ category_code_description <chr> \"SINGLE FAMILY\", \"SINGLE FAMILY\", \"SINGLE FA…\n$ census_tract              <dbl> 41, 287, 356, 184, 191, 158, 313, 356, 255, …\n$ exterior_condition        <dbl> 5, 6, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 4, 6, 4,…\n$ interior_condition        <dbl> 5, 5, 4, 4, 4, 4, 4, 3, 3, 2, 2, 4, 3, 5, 4,…\n$ fireplaces                <dbl> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…\n$ garage_spaces             <dbl> 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1,…\n$ general_construction      <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\",…\n$ market_value              <dbl> 149300, 66700, 327400, 248300, 167900, 57310…\n$ number_of_bathrooms       <dbl> 1, 1, 0, 0, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 0,…\n$ number_of_bedrooms        <dbl> 3, 3, 0, 0, 3, 4, 3, 3, 4, 4, 3, 2, 3, 3, 0,…\n$ basements                 <chr> \"C\", \"F\", \"H\", \"D\", \"H\", \"D\", \"F\", \"A\", \"C\",…\n$ prop_id                   <dbl> 1, 2, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17…\n$ violent_2blocks           <dbl> 47, 90, 1, 5, 65, 14, 63, 2, 8, 100, 53, 70,…\n$ petty_1block              <dbl> 34, 134, 0, 11, 30, 11, 29, 1, 7, 31, 42, 20…\n$ neigh_name                <chr> \"GREENWICH\", \"FELTONVILLE\", \"BUSTLETON\", \"BR…\n$ dist_stop_ft              <dbl> 290.14481, 528.87403, 405.20528, 575.03388, …\n$ dist_bike_ft              <dbl> 690.91700, 399.02685, 510.10879, 512.00309, …\n$ dist_hosp_mi              <dbl> 0.6732689, 1.0606701, 1.8283570, 1.5775431, …\n$ service_band_code         <dbl> 1, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2,…\n$ service_band              <chr> \"Too Close\", \"Within Service\", \"Within Servi…\n$ dist_park_ft              <dbl> 532.22719, 2162.99199, 458.57125, 1032.98525…\n$ dist_park_mi              <dbl> 0.10080060, 0.40965757, 0.08685062, 0.195641…\n$ dist_school_public_ft     <dbl> 1034.0211, 1402.8327, 1924.2342, 919.1067, 7…\n$ dist_school_charter_ft    <dbl> 4064.3577, 1993.0393, 9331.8429, 2393.9853, …\n$ dist_school_private_ft    <dbl> 4204.2677, 1273.8183, 2949.0531, 8442.3491, …\n$ dist_foodretail_ft        <dbl> 436.9721, 308.0973, 1861.4471, 1772.0048, 38…\n$ foodretail_1mi_count      <dbl> 73, 53, 12, 11, 29, 37, 55, 10, 34, 49, 44, …\n$ dist_police_ft            <dbl> 3534.7457, 5291.8207, 3665.9079, 11101.6058,…\n$ dist_fire_ft              <dbl> 1292.8380, 3479.5780, 3775.9104, 710.2274, 2…\n$ lu2_code                  <dbl> 12, 12, 11, 11, 12, 12, 12, 11, 11, 12, 12, …\n$ GEOID                     <dbl> 42101004101, 42101028700, 42101035601, 42101…\n$ pct_white                 <dbl> 28.67553288, 2.04690832, 65.90263307, 91.860…\n$ pct_black                 <dbl> 12.55237748, 23.07036247, 3.63705247, 0.0439…\n$ pct_hispanic              <dbl> 26.9630169, 72.1961620, 10.7785565, 0.527936…\n$ pct_asian                 <dbl> 26.1249772, 2.5586354, 18.7156659, 0.4399472…\n$ pct_age_25_44             <dbl> 33.52159, 18.46482, 16.15836, 28.86054, 32.0…\n$ pct_age_45_64             <dbl> 23.93879, 25.15991, 26.50123, 24.19710, 21.7…\n$ pct_age_65plus            <dbl> 10.511933, 10.575693, 35.404433, 13.418390, …\n$ vacancy_rate              <dbl> 13.8374899, 13.8952164, 2.2861981, 0.7874016…\n$ med_gross_rent            <dbl> 1540, 1271, 1278, 1456, 1199, 1859, 1383, 12…\n$ med_hh_income             <dbl> 72500, 26707, 61939, 73478, 50238, 116629, 6…\n$ poverty_rate              <dbl> 9.601020, 51.897655, 6.755174, 10.502693, 30…\n$ pct_ba_plus               <dbl> 43.285982, 14.004721, 32.637709, 26.671079, …\n$ pct_hs_only               <dbl> 18.922541, 35.798584, 28.148508, 33.686300, …\n$ unemployment_rate         <dbl> 8.270922, 6.795017, 1.609395, 8.025248, 9.97…\n```\n\n\n:::\n:::\n\n\n### Step 2: Load Secondary Data\n\n-   Census data (tidycensus):\n\n-   Spatial amenities (OpenDataPhilly)\n\n-   Join to sales data appropriately\n\n-   Make sure you have the correct CRS!\n\n--------------------------------------------------------------------------------\n\n### Step 3: Feature Engineering\n\n1.  **Buffer-based features**:\n\n    -   Parks within 500ft, 1000ft\n\n    -   Transit stops within 400ft\n\n    -   Schools, crime, etc.\n\n2.  **k-Nearest Neighbor features**:\n\n    -   Average distance to k nearest parks, transit, etc.\n\n3.  **Census variables**:\n\n    -   Join median income, education, poverty, etc.\n\n4.  **Interaction terms**:\n\n    -   Theoretically motivated combinations\n\n--------------------------------------------------------------------------------\n\n### Step 4: Exploratory Data Analysis\n\n**Create at least 5 professional visualizations:**\n\n1.  Distribution of sale prices (histogram)\n\n2.  Geographic distribution (map)\n\n3.  Price vs. structural features (scatter plots)\n\n4.  Price vs. spatial features (scatter plots)\n\n5.  One creative visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create New Columns for Further Cleaning\nsales_data <- sales_data |> \n  mutate(psf = round(sale_price / total_livable_area, 2),\n         value_multiple = round(market_value / sale_price, 2)) |> \n  arrange(psf)\nsales_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19,736 × 53\n   sale_date           sale_price total_area total_livable_area year_built\n   <dttm>                   <dbl>      <dbl>              <dbl>      <dbl>\n 1 2024-03-11 08:00:00      10000      14895               4200       1900\n 2 2024-02-22 10:00:00      12000       1150               2400       2014\n 3 2024-03-15 08:00:00      10000       1575               1656       1940\n 4 2023-09-06 08:00:00      15000       1201               2451       1915\n 5 2023-10-17 08:00:00      10000       1700               1516       1935\n 6 2024-08-06 08:00:00      14500        946               1892       1915\n 7 2023-11-17 10:00:00      10000        923               1260       1920\n 8 2023-01-17 10:00:00      10000       1410               1260       1940\n 9 2023-07-27 08:00:00      10000        821               1189       1925\n10 2023-07-07 08:00:00      11000       1156               1290       1940\n# ℹ 19,726 more rows\n# ℹ 48 more variables: category_code <dbl>, category_code_description <chr>,\n#   census_tract <dbl>, exterior_condition <dbl>, interior_condition <dbl>,\n#   fireplaces <dbl>, garage_spaces <dbl>, general_construction <chr>,\n#   market_value <dbl>, number_of_bathrooms <dbl>, number_of_bedrooms <dbl>,\n#   basements <chr>, prop_id <dbl>, violent_2blocks <dbl>, petty_1block <dbl>,\n#   neigh_name <chr>, dist_stop_ft <dbl>, dist_bike_ft <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(sales_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"sale_date\"                 \"sale_price\"               \n [3] \"total_area\"                \"total_livable_area\"       \n [5] \"year_built\"                \"category_code\"            \n [7] \"category_code_description\" \"census_tract\"             \n [9] \"exterior_condition\"        \"interior_condition\"       \n[11] \"fireplaces\"                \"garage_spaces\"            \n[13] \"general_construction\"      \"market_value\"             \n[15] \"number_of_bathrooms\"       \"number_of_bedrooms\"       \n[17] \"basements\"                 \"prop_id\"                  \n[19] \"violent_2blocks\"           \"petty_1block\"             \n[21] \"neigh_name\"                \"dist_stop_ft\"             \n[23] \"dist_bike_ft\"              \"dist_hosp_mi\"             \n[25] \"service_band_code\"         \"service_band\"             \n[27] \"dist_park_ft\"              \"dist_park_mi\"             \n[29] \"dist_school_public_ft\"     \"dist_school_charter_ft\"   \n[31] \"dist_school_private_ft\"    \"dist_foodretail_ft\"       \n[33] \"foodretail_1mi_count\"      \"dist_police_ft\"           \n[35] \"dist_fire_ft\"              \"lu2_code\"                 \n[37] \"GEOID\"                     \"pct_white\"                \n[39] \"pct_black\"                 \"pct_hispanic\"             \n[41] \"pct_asian\"                 \"pct_age_25_44\"            \n[43] \"pct_age_45_64\"             \"pct_age_65plus\"           \n[45] \"vacancy_rate\"              \"med_gross_rent\"           \n[47] \"med_hh_income\"             \"poverty_rate\"             \n[49] \"pct_ba_plus\"               \"pct_hs_only\"              \n[51] \"unemployment_rate\"         \"psf\"                      \n[53] \"value_multiple\"           \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram of Price\nggplot(sales_data, aes(x = sale_price)) +\n  geom_histogram(fill = \"lightblue\", bins= 500) +\n  labs(title = \"Histogram of Price\", x = \"Price\", y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](midterm-final-model_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Log Sales Price\nlog_sales_data <- mutate(sales_data, log_price = log(sale_price))\nggplot(log_sales_data, aes(x = log_price)) +\n  geom_histogram(fill = \"lightblue\", bins= 500) +\n  labs(title = \"Histogram of Price\", x = \"Log(Price)\", y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](midterm-final-model_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Further Cleaning\nselect_data <- sales_data |> \n  select(year_built, number_of_bathrooms, number_of_bedrooms, basements, \n         fireplaces, garage_spaces,\n         general_construction, interior_condition, exterior_condition, \n         census_tract, neigh_name, \n         value_multiple, market_value, sale_price, total_area, total_livable_area, \n         psf, violent_2blocks, petty_1block, dist_park_mi, \n         vacancy_rate, med_gross_rent, med_hh_income, pct_ba_plus, \n         pct_white, pct_black, pct_hispanic, pct_asian,\n         foodretail_1mi_count, \n         dist_school_public_ft, dist_school_charter_ft, \n         pct_age_25_44, pct_age_65plus,\n         poverty_rate, unemployment_rate) |> \n  filter(number_of_bathrooms > 0, number_of_bedrooms > 0) |> \n  mutate(age = 2024 - year_built,\n         basements = dplyr::recode(trimws(as.character(basements)),\n                              \"0\"=\"0\",\"A\"=\"1\",\"B\"=\"2\",\"C\"=\"3\",\"D\"=\"4\",\"E\"=\"5\",\n                              \"F\"=\"6\",\"G\"=\"7\",\"H\"=\"8\",\"I\"=\"9\"),\n         basements = as.integer(basements)) |> \n  rename(\n    baths      = number_of_bathrooms,\n    beds       = number_of_bedrooms,\n    construction = general_construction,\n    interior   = interior_condition,\n    exterior   = exterior_condition,\n    garage     = garage_spaces,\n    tract      = census_tract,\n    neigh      = neigh_name,\n    mkt_value  = market_value,\n    area       = total_area,\n    liv_area   = total_livable_area\n  )\n\n# Intuition: market value should not deviate substantially \n# from the sale price\nvalue_range <- select_data |> \n  summarize(\n    q1 = quantile(value_multiple, 0.25, na.rm = TRUE),\n    q3 = quantile(value_multiple, 0.75, na.rm = TRUE),\n    iqr = q3 - q1,\n    lower = q1 - 1.5 * iqr,\n    upper = q3 + 1.5 * iqr)\nvalue_range\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n     q1    q3   iqr lower upper\n  <dbl> <dbl> <dbl> <dbl> <dbl>\n1  0.87  1.16  0.29 0.435  1.59\n```\n\n\n:::\n\n```{.r .cell-code}\n# Intuition: psf outliers are likely non-market transactions\npsf_range <- select_data |> \n  summarize(\n    q1 = quantile(psf, 0.25, na.rm = TRUE),\n    q3 = quantile(psf, 0.75, na.rm = TRUE),\n    iqr = q3 - q1,\n    lower = q1 - 1.5 * iqr,\n    upper = q3 + 1.5 * iqr)\npsf_range  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n     q1    q3   iqr lower upper\n  <dbl> <dbl> <dbl> <dbl> <dbl>\n1  132.  267.  135. -70.6  469.\n```\n\n\n:::\n\n```{.r .cell-code}\nclean_data <- select_data |> \n  filter(\n    liv_area > 500,\n    area > 500,\n    between(psf, 40, 800),\n    between(value_multiple, 0.4, 2.0)\n  ) |> \n  mutate(across(where(is.numeric), ~ round(.x, 2))) |> \n  drop_na() |> \n  arrange(liv_area)\nclean_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 17,174 × 36\n   year_built baths  beds basements fireplaces garage construction interior\n        <dbl> <dbl> <dbl>     <dbl>      <dbl>  <dbl> <chr>           <dbl>\n 1       1920     1     1         4          0      0 A                   2\n 2       1920     1     2         3          0      0 A                   4\n 3       1915     1     1         4          0      0 A                   4\n 4       1920     1     2         5          0      0 A                   2\n 5       1920     1     2         3          0      0 A                   3\n 6       1920     1     2         1          0      0 A                   2\n 7       1920     1     2         1          0      0 A                   2\n 8       1920     1     2         2          0      0 A                   2\n 9       1875     1     2         3          0      0 A                   4\n10       1875     1     2         3          0      0 A                   3\n# ℹ 17,164 more rows\n# ℹ 28 more variables: exterior <dbl>, tract <dbl>, neigh <chr>,\n#   value_multiple <dbl>, mkt_value <dbl>, sale_price <dbl>, area <dbl>,\n#   liv_area <dbl>, psf <dbl>, violent_2blocks <dbl>, petty_1block <dbl>,\n#   dist_park_mi <dbl>, vacancy_rate <dbl>, med_gross_rent <dbl>,\n#   med_hh_income <dbl>, pct_ba_plus <dbl>, pct_white <dbl>, pct_black <dbl>,\n#   pct_hispanic <dbl>, pct_asian <dbl>, foodretail_1mi_count <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quick Category Check \ncount(clean_data, neigh)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 144 × 2\n   neigh                n\n   <chr>            <int>\n 1 ACADEMY_GARDENS     65\n 2 ALLEGHENY_WEST     160\n 3 ANDORRA             38\n 4 ASTON_WOODBRIDGE    43\n 5 BARTRAM_VILLAGE     14\n 6 BELLA_VISTA         80\n 7 BELMONT             18\n 8 BLUE_BELL_HILL       5\n 9 BREWERYTOWN        147\n10 BRIDESBURG         114\n# ℹ 134 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, interior)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  interior     n\n     <dbl> <int>\n1        1   362\n2        2  3058\n3        3  3831\n4        4  9774\n5        5   103\n6        6    24\n7        7    22\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, exterior)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  exterior     n\n     <dbl> <int>\n1        1   368\n2        2   645\n3        3  1833\n4        4 14122\n5        5   161\n6        6    12\n7        7    33\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, basements)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n   basements     n\n       <dbl> <int>\n 1         0   268\n 2         1  3868\n 3         2   814\n 4         3  4234\n 5         4  3046\n 6         5  1706\n 7         6  1810\n 8         7   483\n 9         8   915\n10         9    30\n```\n\n\n:::\n:::\n\n\n**Metadata: Interior and Exterior Condition**\n\n1.  Newer Construction\n2.  Rehabilitated\n3.  Above Average\n4.  Rehabilitated\n5.  Average\n6.  Below Average\n7.  Vacant\n\n**Metadata: Basements**\n\n0.  None\n1.  A = Full Finished\n2.  B = Full Semi-Finished\n3.  C = Full Unfinished\n4.  D = Full\n5.  E = Partial Finished\n6.  F = Partial Semi-Finished\n7.  G = Partial Unfinished\n8.  H = Partial - Unknown Finish\n9.  I = Unknown Size - Finished\n\n### Step 5: Summary Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate Summary Stats\nstats_df <- clean_data %>%\n  summarise(across(\n    where(is.numeric),\n    list(\n      mean   = ~ mean(.x, na.rm = TRUE),\n      median = ~ median(.x, na.rm = TRUE),\n      sd     = ~ sd(.x, na.rm = TRUE),\n      q25    = ~ as.numeric(quantile(.x, 0.25, na.rm = TRUE)),\n      q75    = ~ as.numeric(quantile(.x, 0.75, na.rm = TRUE))\n    ),\n    .names = \"{.col}__{.fn}\"\n  )) %>%\n  pivot_longer(everything(),\n               names_to = c(\"variable\",\"stat\"),\n               names_sep = \"__\",\n               values_to = \"value\") %>%\n  pivot_wider(names_from = stat, values_from = value) %>%\n  mutate(across(-variable, ~ round(.x, 2))) %>%\n  arrange(variable)\n\n# Table Output\nlibrary(kableExtra)\nkbl(stats_df,\n    caption   = \"Summary Statistics\",\n    col.names = c(\"Variable\",\"Mean\",\"Median\",\"SD\",\"Q25\",\"Q75\"),\n    align     = c(\"l\",\"r\",\"r\",\"r\",\"r\",\"r\"),\n    booktabs  = TRUE\n) %>%\n  kable_styling(full_width = FALSE,\n                bootstrap_options = c(\"striped\",\"hover\",\"condensed\")) %>%\n  add_header_above(c(\" \" = 1, \"Statistics\" = 5))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"5\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Statistics</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> Median </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Q25 </th>\n   <th style=\"text-align:right;\"> Q75 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 87.43 </td>\n   <td style=\"text-align:right;\"> 99.00 </td>\n   <td style=\"text-align:right;\"> 28.15 </td>\n   <td style=\"text-align:right;\"> 74.00 </td>\n   <td style=\"text-align:right;\"> 104.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> area </td>\n   <td style=\"text-align:right;\"> 1968.09 </td>\n   <td style=\"text-align:right;\"> 1226.00 </td>\n   <td style=\"text-align:right;\"> 4042.11 </td>\n   <td style=\"text-align:right;\"> 896.00 </td>\n   <td style=\"text-align:right;\"> 1845.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> basements </td>\n   <td style=\"text-align:right;\"> 3.54 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n   <td style=\"text-align:right;\"> 2.04 </td>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> 5.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> baths </td>\n   <td style=\"text-align:right;\"> 1.46 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 2.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> beds </td>\n   <td style=\"text-align:right;\"> 3.09 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n   <td style=\"text-align:right;\"> 0.72 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dist_park_mi </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n   <td style=\"text-align:right;\"> 0.14 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dist_school_charter_ft </td>\n   <td style=\"text-align:right;\"> 3387.13 </td>\n   <td style=\"text-align:right;\"> 2676.00 </td>\n   <td style=\"text-align:right;\"> 2520.44 </td>\n   <td style=\"text-align:right;\"> 1704.38 </td>\n   <td style=\"text-align:right;\"> 4255.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dist_school_public_ft </td>\n   <td style=\"text-align:right;\"> 1531.73 </td>\n   <td style=\"text-align:right;\"> 1362.89 </td>\n   <td style=\"text-align:right;\"> 902.98 </td>\n   <td style=\"text-align:right;\"> 894.00 </td>\n   <td style=\"text-align:right;\"> 1945.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> exterior </td>\n   <td style=\"text-align:right;\"> 3.77 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n   <td style=\"text-align:right;\"> 0.65 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> fireplaces </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.35 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> foodretail_1mi_count </td>\n   <td style=\"text-align:right;\"> 44.55 </td>\n   <td style=\"text-align:right;\"> 45.00 </td>\n   <td style=\"text-align:right;\"> 20.61 </td>\n   <td style=\"text-align:right;\"> 30.00 </td>\n   <td style=\"text-align:right;\"> 57.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> garage </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> interior </td>\n   <td style=\"text-align:right;\"> 3.37 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n   <td style=\"text-align:right;\"> 0.87 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> liv_area </td>\n   <td style=\"text-align:right;\"> 1379.56 </td>\n   <td style=\"text-align:right;\"> 1224.00 </td>\n   <td style=\"text-align:right;\"> 579.84 </td>\n   <td style=\"text-align:right;\"> 1076.00 </td>\n   <td style=\"text-align:right;\"> 1500.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> med_gross_rent </td>\n   <td style=\"text-align:right;\"> 1368.47 </td>\n   <td style=\"text-align:right;\"> 1320.00 </td>\n   <td style=\"text-align:right;\"> 312.66 </td>\n   <td style=\"text-align:right;\"> 1155.00 </td>\n   <td style=\"text-align:right;\"> 1561.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> med_hh_income </td>\n   <td style=\"text-align:right;\"> 69281.93 </td>\n   <td style=\"text-align:right;\"> 63628.00 </td>\n   <td style=\"text-align:right;\"> 30345.38 </td>\n   <td style=\"text-align:right;\"> 46492.00 </td>\n   <td style=\"text-align:right;\"> 86222.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mkt_value </td>\n   <td style=\"text-align:right;\"> 294129.43 </td>\n   <td style=\"text-align:right;\"> 244000.00 </td>\n   <td style=\"text-align:right;\"> 228503.89 </td>\n   <td style=\"text-align:right;\"> 166725.00 </td>\n   <td style=\"text-align:right;\"> 341075.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_age_25_44 </td>\n   <td style=\"text-align:right;\"> 34.08 </td>\n   <td style=\"text-align:right;\"> 30.18 </td>\n   <td style=\"text-align:right;\"> 11.98 </td>\n   <td style=\"text-align:right;\"> 26.18 </td>\n   <td style=\"text-align:right;\"> 40.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_age_65plus </td>\n   <td style=\"text-align:right;\"> 13.76 </td>\n   <td style=\"text-align:right;\"> 12.59 </td>\n   <td style=\"text-align:right;\"> 6.78 </td>\n   <td style=\"text-align:right;\"> 8.33 </td>\n   <td style=\"text-align:right;\"> 17.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_asian </td>\n   <td style=\"text-align:right;\"> 7.29 </td>\n   <td style=\"text-align:right;\"> 4.58 </td>\n   <td style=\"text-align:right;\"> 8.53 </td>\n   <td style=\"text-align:right;\"> 1.08 </td>\n   <td style=\"text-align:right;\"> 10.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_ba_plus </td>\n   <td style=\"text-align:right;\"> 34.37 </td>\n   <td style=\"text-align:right;\"> 28.22 </td>\n   <td style=\"text-align:right;\"> 22.78 </td>\n   <td style=\"text-align:right;\"> 15.84 </td>\n   <td style=\"text-align:right;\"> 51.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_black </td>\n   <td style=\"text-align:right;\"> 33.57 </td>\n   <td style=\"text-align:right;\"> 20.15 </td>\n   <td style=\"text-align:right;\"> 31.87 </td>\n   <td style=\"text-align:right;\"> 6.56 </td>\n   <td style=\"text-align:right;\"> 54.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_hispanic </td>\n   <td style=\"text-align:right;\"> 15.51 </td>\n   <td style=\"text-align:right;\"> 8.68 </td>\n   <td style=\"text-align:right;\"> 17.81 </td>\n   <td style=\"text-align:right;\"> 4.48 </td>\n   <td style=\"text-align:right;\"> 18.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pct_white </td>\n   <td style=\"text-align:right;\"> 38.82 </td>\n   <td style=\"text-align:right;\"> 36.08 </td>\n   <td style=\"text-align:right;\"> 29.69 </td>\n   <td style=\"text-align:right;\"> 8.50 </td>\n   <td style=\"text-align:right;\"> 67.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> petty_1block </td>\n   <td style=\"text-align:right;\"> 29.09 </td>\n   <td style=\"text-align:right;\"> 25.00 </td>\n   <td style=\"text-align:right;\"> 29.48 </td>\n   <td style=\"text-align:right;\"> 15.00 </td>\n   <td style=\"text-align:right;\"> 36.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> poverty_rate </td>\n   <td style=\"text-align:right;\"> 19.63 </td>\n   <td style=\"text-align:right;\"> 17.26 </td>\n   <td style=\"text-align:right;\"> 12.56 </td>\n   <td style=\"text-align:right;\"> 10.30 </td>\n   <td style=\"text-align:right;\"> 26.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> psf </td>\n   <td style=\"text-align:right;\"> 213.18 </td>\n   <td style=\"text-align:right;\"> 200.22 </td>\n   <td style=\"text-align:right;\"> 101.73 </td>\n   <td style=\"text-align:right;\"> 142.00 </td>\n   <td style=\"text-align:right;\"> 266.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sale_price </td>\n   <td style=\"text-align:right;\"> 304050.36 </td>\n   <td style=\"text-align:right;\"> 250000.00 </td>\n   <td style=\"text-align:right;\"> 243673.32 </td>\n   <td style=\"text-align:right;\"> 170000.00 </td>\n   <td style=\"text-align:right;\"> 359000.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> tract </td>\n   <td style=\"text-align:right;\"> 200.52 </td>\n   <td style=\"text-align:right;\"> 202.00 </td>\n   <td style=\"text-align:right;\"> 118.79 </td>\n   <td style=\"text-align:right;\"> 85.00 </td>\n   <td style=\"text-align:right;\"> 314.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> unemployment_rate </td>\n   <td style=\"text-align:right;\"> 8.38 </td>\n   <td style=\"text-align:right;\"> 7.19 </td>\n   <td style=\"text-align:right;\"> 5.70 </td>\n   <td style=\"text-align:right;\"> 3.89 </td>\n   <td style=\"text-align:right;\"> 11.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> vacancy_rate </td>\n   <td style=\"text-align:right;\"> 8.85 </td>\n   <td style=\"text-align:right;\"> 7.84 </td>\n   <td style=\"text-align:right;\"> 5.74 </td>\n   <td style=\"text-align:right;\"> 4.77 </td>\n   <td style=\"text-align:right;\"> 11.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> value_multiple </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 0.99 </td>\n   <td style=\"text-align:right;\"> 0.26 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> violent_2blocks </td>\n   <td style=\"text-align:right;\"> 44.85 </td>\n   <td style=\"text-align:right;\"> 35.00 </td>\n   <td style=\"text-align:right;\"> 39.37 </td>\n   <td style=\"text-align:right;\"> 17.00 </td>\n   <td style=\"text-align:right;\"> 61.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> year_built </td>\n   <td style=\"text-align:right;\"> 1936.57 </td>\n   <td style=\"text-align:right;\"> 1925.00 </td>\n   <td style=\"text-align:right;\"> 28.15 </td>\n   <td style=\"text-align:right;\"> 1920.00 </td>\n   <td style=\"text-align:right;\"> 1950.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Correlation Matrix**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhedonic_vars <- clean_data[, c(\"age\", \"baths\", \"beds\", \"basements\", \"interior\", \"exterior\", \"area\", \"liv_area\")]\n\ncor_matrix <- cor(hedonic_vars, use = \"pairwise.complete.obs\", method = \"pearson\")\n\nggcorrplot(cor_matrix,\n           method = \"square\",\n           type = \"lower\",\n           lab = TRUE,\n           lab_size = 3,\n           colors = c(\"#a4133c\", \"white\", \"#a4133c\"))+\n    labs(title = \"Correlation Matrix for Hedonic Variables\") +\n    theme(plot.subtitle = element_text(size = 9, face = \"italic\"),\n        plot.title = element_text(size = 12, face = \"bold\"),\n        axis.text.x = element_text(size = 7),\n        axis.text.y = element_text(size = 7),\n        axis.title = element_text(size = 8))\n```\n\n::: {.cell-output-display}\n![](midterm-final-model_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspatial_vars <- clean_data[, c(\n  \"violent_2blocks\", \"petty_1block\", \"dist_park_mi\",\n  \"vacancy_rate\", \"med_gross_rent\", \"med_hh_income\", \"pct_ba_plus\",\n  \"pct_white\", \"pct_black\", \"pct_hispanic\", \"pct_asian\",\n  \"foodretail_1mi_count\",\n  \"dist_school_public_ft\", \"dist_school_charter_ft\",\n  \"pct_age_25_44\", \"pct_age_65plus\",\n  \"poverty_rate\", \"unemployment_rate\"\n)]\n\nspatial_matrix <- cor(spatial_vars, use = \"pairwise.complete.obs\", method = \"pearson\")\n\nggcorrplot(spatial_matrix,\n           method = \"square\",\n           type = \"lower\",\n           lab = TRUE,\n           lab_size = 3,\n           colors = c(\"#a4133c\", \"white\", \"#a4133c\"))+\n    labs(title = \"Correlation Matrix for Spatial Variables\") +\n    theme(plot.subtitle = element_text(size = 9, face = \"italic\"),\n        plot.title = element_text(size = 12, face = \"bold\"),\n        axis.text.x = element_text(size = 7),\n        axis.text.y = element_text(size = 7),\n        axis.title = element_text(size = 8))\n```\n\n::: {.cell-output-display}\n![](midterm-final-model_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n--------------------------------------------------------------------------------\n\n## Part 2: Model Building & Evaluation using Cross-Validation\n\n--------------------------------------------------------------------------------\n\nEvaluate the model fit and predictive reliability using key metrics such as Mean\nAbsolute Error (MAE), Root Mean Squared Error (RMSE), and R-squared.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclean_data$neigh <- as.factor(clean_data$neigh)\nclean_data$interior <- as.factor(clean_data$interior)\nclean_data$exterior <- as.factor(clean_data$exterior)\nclean_data$basements <- as.factor(clean_data$basements)\n                                 \ncount(clean_data, neigh)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 144 × 2\n   neigh                n\n   <fct>            <int>\n 1 ACADEMY_GARDENS     65\n 2 ALLEGHENY_WEST     160\n 3 ANDORRA             38\n 4 ASTON_WOODBRIDGE    43\n 5 BARTRAM_VILLAGE     14\n 6 BELLA_VISTA         80\n 7 BELMONT             18\n 8 BLUE_BELL_HILL       5\n 9 BREWERYTOWN        147\n10 BRIDESBURG         114\n# ℹ 134 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, interior)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  interior     n\n  <fct>    <int>\n1 1          362\n2 2         3058\n3 3         3831\n4 4         9774\n5 5          103\n6 6           24\n7 7           22\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, exterior)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  exterior     n\n  <fct>    <int>\n1 1          368\n2 2          645\n3 3         1833\n4 4        14122\n5 5          161\n6 6           12\n7 7           33\n```\n\n\n:::\n\n```{.r .cell-code}\ncount(clean_data, basements)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 2\n   basements     n\n   <fct>     <int>\n 1 0           268\n 2 1          3868\n 3 2           814\n 4 3          4234\n 5 4          3046\n 6 5          1706\n 7 6          1810\n 8 7           483\n 9 8           915\n10 9            30\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(5080) # Set seed for reproducibility\nctrl <- trainControl(method = \"cv\", number = 10) #10-Fold CV\n\n# Model 1: Structural\ncv_m1 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2),\n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Model 2: + Spatial\ncv_m2 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2) +\n  dist_park_mi + foodretail_1mi_count + dist_school_public_ft\n  + vacancy_rate + med_gross_rent + med_hh_income + pct_ba_plus + pct_black + pct_white\n  + poverty_rate + unemployment_rate + pct_age_25_44 + pct_age_65plus,\n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Model 3: + Neighborhood Fixed Effects\ncv_m3 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2) +\n  dist_park_mi + foodretail_1mi_count + dist_school_public_ft +\n  vacancy_rate + med_gross_rent + med_hh_income + pct_ba_plus + pct_black + pct_white +\n  poverty_rate + unemployment_rate + pct_age_25_44 + pct_age_65plus +\n  neigh, \n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Model 4: + Small Neighborhoods + Mkt Value\nclean_data <- clean_data |> \n  add_count(neigh) |> \n  mutate(\n    neigh_cv = if_else(\n      n < 10,                       # If fewer than 10 sales\n      \"Small_Neighborhoods\",        # Group them\n      as.character(neigh)           # Keep original\n    ),\n    neigh_cv = as.factor(neigh_cv)\n  )\n\ncv_m4 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2) +\n  violent_2blocks + dist_park_mi + foodretail_1mi_count + dist_school_public_ft + \n  vacancy_rate + med_gross_rent + med_hh_income + pct_ba_plus + pct_black + pct_white +\n  poverty_rate + unemployment_rate + pct_age_25_44 + pct_age_65plus + \n  mkt_value +\n  neigh_cv, \n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Model 5: + Simpler + Mkt Value\ncv_m5 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2) +\n  dist_park_mi + foodretail_1mi_count + dist_school_public_ft +\n  mkt_value +\n  neigh_cv,  \n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Model 6: Simpler Only\ncv_m6 <- train(\n  sale_price ~ beds + baths + basements + interior + exterior + liv_area + poly(age, 2) +\n  dist_park_mi + foodretail_1mi_count + dist_school_public_ft + \n  neigh_cv,  \n  data = clean_data, method = \"lm\", trControl = ctrl\n)\n\n# Compare\ndata.frame(\n  Model = c(\"Structural\", \"Spatial\", \"Fixed Effects\", \"Small Neighborhoods + Mkt Value\", \"Simpler + Mkt Value\", \"Simpler Only\"),\n  Rsquared = c(cv_m1$results$Rsquared, cv_m2$results$Rsquared, cv_m3$results$Rsquared, \n               cv_m4$results$Rsquared, cv_m5$results$Rsquared, cv_m6$results$Rsquared),\n  RMSE = c(cv_m1$results$RMSE, cv_m2$results$RMSE, cv_m3$results$RMSE, \n           cv_m4$results$RMSE, cv_m5$results$RMSE, cv_m6$results$RMSE),\n  MAE = c(cv_m1$results$MAE, cv_m2$results$MAE, cv_m3$results$MAE, \n          cv_m4$results$MAE, cv_m5$results$MAE, cv_m6$results$MAE)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            Model  Rsquared      RMSE      MAE\n1                      Structural 0.6734982 139097.27 91009.99\n2                         Spatial 0.7910435 111374.22 67559.44\n3                   Fixed Effects 0.8489664  95369.77 56768.27\n4 Small Neighborhoods + Mkt Value 0.9266800  65382.05 42496.50\n5             Simpler + Mkt Value 0.9282046  65402.58 42527.28\n6                    Simpler Only 0.8415987  96901.51 58377.83\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_model3 <- cv_m3$finalModel\nvif_model3 <- vif(lm_model3)\nvif_m3 <- data.frame(Variable = names(vif_model3), # convert to data frame\n                     VIF = as.vector(vif_model3))\nkable(vif_m3, caption = \"Variance Inflation Factors for Model 3: Fixed Effects\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Variance Inflation Factors for Model 3: Fixed Effects\n\n|Variable                  |        VIF|\n|:-------------------------|----------:|\n|beds                      |   2.049265|\n|baths                     |   2.214022|\n|basements1                |  14.301690|\n|basements2                |   4.494605|\n|basements3                |  15.741349|\n|basements4                |  12.630752|\n|basements5                |   7.769069|\n|basements6                |   8.457106|\n|basements7                |   3.162235|\n|basements8                |   4.963679|\n|basements9                |   1.148218|\n|interior2                 | 433.595343|\n|interior3                 | 511.190303|\n|interior4                 | 725.322963|\n|interior5                 |  18.775469|\n|interior6                 |   5.373467|\n|interior7                 |   6.004538|\n|exterior2                 | 107.584125|\n|exterior3                 | 280.208816|\n|exterior4                 | 430.490151|\n|exterior5                 |  28.543354|\n|exterior6                 |   3.252689|\n|exterior7                 |   7.935073|\n|liv_area                  |   2.840232|\n|`poly(age, 2)1`           |   2.474318|\n|`poly(age, 2)2`           |   2.113020|\n|dist_park_mi              |   1.449398|\n|foodretail_1mi_count      |  10.018463|\n|dist_school_public_ft     |   1.949979|\n|vacancy_rate              |   3.542389|\n|med_gross_rent            |   4.496201|\n|med_hh_income             |   9.248076|\n|pct_ba_plus               |  19.605835|\n|pct_black                 |  21.261745|\n|pct_white                 |  19.614209|\n|poverty_rate              |   5.199561|\n|unemployment_rate         |   2.417667|\n|pct_age_25_44             |   6.518760|\n|pct_age_65plus            |   3.712982|\n|neighALLEGHENY_WEST       |   4.682976|\n|neighANDORRA              |   1.729573|\n|neighASTON_WOODBRIDGE     |   1.754919|\n|neighBARTRAM_VILLAGE      |   1.324190|\n|neighBELLA_VISTA          |   3.019564|\n|neighBELMONT              |   1.433535|\n|neighBLUE_BELL_HILL       |   1.126132|\n|neighBREWERYTOWN          |   4.323633|\n|neighBRIDESBURG           |   2.884220|\n|neighBURHOLME             |   1.378201|\n|neighBUSTLETON            |   4.917405|\n|neighCARROLL_PARK         |   4.085431|\n|neighCEDAR_PARK           |   3.092098|\n|neighCEDARBROOK           |   3.928959|\n|neighCHESTNUT_HILL        |   4.253643|\n|neighCLEARVIEW            |   1.709857|\n|neighCOBBS_CREEK          |   9.434200|\n|neighCRESCENTVILLE        |   1.088240|\n|neighDEARNLEY_PARK        |   1.207802|\n|neighDICKINSON_NARROWS    |   4.163236|\n|neighDUNLAP               |   1.562388|\n|neighEAST_FALLS           |   4.717792|\n|neighEAST_KENSINGTON      |   4.738747|\n|neighEAST_OAK_LANE        |   2.392539|\n|neighEAST_PARK            |   1.023240|\n|neighEAST_PARKSIDE        |   1.553629|\n|neighEAST_PASSYUNK        |   5.950768|\n|neighEAST_POPLAR          |   1.068445|\n|neighEASTWICK             |   1.626392|\n|neighELMWOOD              |   5.022162|\n|neighFAIRHILL             |   1.495718|\n|neighFAIRMOUNT            |   6.092245|\n|neighFELTONVILLE          |   3.739039|\n|neighFERN_ROCK            |   1.742725|\n|neighFISHTOWN             |  11.059002|\n|neighFITLER_SQUARE        |   1.729380|\n|neighFOX_CHASE            |   4.434731|\n|neighFRANCISVILLE         |   2.296713|\n|neighFRANKFORD            |   5.117177|\n|neighFRANKLINVILLE        |   1.937673|\n|neighGARDEN_COURT         |   1.372308|\n|neighGERMANTOWN_EAST      |   3.434410|\n|neighGERMANTOWN_MORTON    |   2.171998|\n|neighGERMANTOWN_PENN_KNOX |   1.248988|\n|neighGERMANTOWN_SOUTHWEST |   2.540385|\n|neighGERMANTOWN_WEST_CENT |   1.974975|\n|neighGERMANTOWN_WESTSIDE  |   1.411555|\n|neighGERMANY_HILL         |   2.167678|\n|neighGIRARD_ESTATES       |   4.573653|\n|neighGLENWOOD             |   2.036976|\n|neighGRADUATE_HOSPITAL    |   8.437837|\n|neighGRAYS_FERRY          |   6.580249|\n|neighGREENWICH            |   2.222646|\n|neighHADDINGTON           |   5.933569|\n|neighHARROWGATE           |   5.564070|\n|neighHARTRANFT            |   2.471315|\n|neighHAVERFORD_NORTH      |   1.319760|\n|neighHAWTHORNE            |   2.105040|\n|neighHOLMESBURG           |   6.727475|\n|neighHUNTING_PARK         |   3.499835|\n|neighJUNIATA_PARK         |   5.201612|\n|neighKINGSESSING          |   6.253649|\n|neighLAWNDALE             |   5.408713|\n|neighLEXINGTON_PARK       |   1.831462|\n|neighLOGAN                |   4.799513|\n|neighLOGAN_SQUARE         |   1.528557|\n|neighLOWER_MOYAMENSING    |   6.782643|\n|neighLUDLOW               |   1.088475|\n|neighMANAYUNK             |   5.774279|\n|neighMANTUA               |   2.021614|\n|neighMAYFAIR              |  11.766631|\n|neighMCGUIRE              |   1.400103|\n|neighMECHANICSVILLE       |   1.038126|\n|neighMELROSE_PARK_GARDENS |   1.823393|\n|neighMILL_CREEK           |   2.349579|\n|neighMILLBROOK            |   2.398227|\n|neighMODENA               |   3.418338|\n|neighMORRELL_PARK         |   3.112724|\n|neighMOUNT_AIRY_EAST      |   5.973708|\n|neighMOUNT_AIRY_WEST      |   4.712264|\n|neighNEWBOLD              |   4.188107|\n|neighNICETOWN             |   1.255634|\n|neighNORMANDY_VILLAGE     |   1.215620|\n|neighNORTH_CENTRAL        |   2.968110|\n|neighNORTHERN_LIBERTIES   |   3.731773|\n|neighNORTHWOOD            |   2.190233|\n|neighOGONTZ               |   3.559671|\n|neighOLD_CITY             |   1.291230|\n|neighOLD_KENSINGTON       |   3.024091|\n|neighOLNEY                |   8.078969|\n|neighOVERBROOK            |   6.772090|\n|neighOXFORD_CIRCLE        |  12.558674|\n|neighPACKER_PARK          |   1.850966|\n|neighPARKWOOD_MANOR       |   4.730816|\n|neighPASCHALL             |   3.254948|\n|neighPASSYUNK_SQUARE      |   5.041187|\n|neighPENNSPORT            |   3.749722|\n|neighPENNYPACK            |   2.970297|\n|neighPENNYPACK_WOODS      |   1.373448|\n|neighPENROSE              |   1.844699|\n|neighPOINT_BREEZE         |  13.274515|\n|neighPOWELTON             |   1.170423|\n|neighQUEEN_VILLAGE        |   3.163962|\n|neighRHAWNHURST           |   4.316231|\n|neighRICHMOND             |  10.008276|\n|neighRITTENHOUSE          |   3.477658|\n|neighRIVERFRONT           |   1.055313|\n|neighROXBOROUGH           |   5.747575|\n|neighROXBOROUGH_PARK      |   1.461860|\n|neighSHARSWOOD            |   1.357025|\n|neighSOCIETY_HILL         |   2.992026|\n|neighSOMERTON             |   5.688279|\n|neighSOUTHWEST_SCHUYLKILL |   3.296779|\n|neighSPRING_GARDEN        |   2.370461|\n|neighSPRUCE_HILL          |   1.949239|\n|neighSTADIUM_DISTRICT     |   2.144494|\n|neighSTANTON              |   4.070961|\n|neighSTRAWBERRY_MANSION   |   3.887767|\n|neighSUMMERDALE           |   3.192886|\n|neighTACONY               |   5.456290|\n|neighTIOGA                |   2.857180|\n|neighTORRESDALE           |   2.599110|\n|neighUNIVERSITY_CITY      |   1.040846|\n|neighUPPER_KENSINGTON     |   5.669766|\n|neighUPPER_ROXBOROUGH     |   3.483232|\n|neighWALNUT_HILL          |   1.856734|\n|neighWASHINGTON_SQUARE    |   2.668939|\n|neighWEST_KENSINGTON      |   3.310909|\n|neighWEST_OAK_LANE        |  10.682921|\n|neighWEST_PARKSIDE        |   1.097074|\n|neighWEST_PASSYUNK        |   5.442566|\n|neighWEST_POPLAR          |   1.286419|\n|neighWEST_POWELTON        |   1.462303|\n|neighWHITMAN              |   4.043836|\n|neighWINCHESTER_PARK      |   1.438090|\n|neighWISSAHICKON          |   3.143050|\n|neighWISSAHICKON_HILLS    |   1.528008|\n|neighWISSINOMING          |   7.531934|\n|neighWISTER               |   1.774620|\n|neighWOODLAND_TERRACE     |   1.169262|\n|neighWYNNEFIELD           |   3.978670|\n|neighWYNNEFIELD_HEIGHTS   |   1.255465|\n|neighYORKTOWN             |   1.265892|\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_model5 <- cv_m5$finalModel\nvif_model5 <- vif(lm_model5)\nvif_m5 <- data.frame(Variable = names(vif_model5), # convert to data frame\n                     VIF = as.vector(vif_model5))\nkable(vif_m5, caption = \"Variance Inflation Factors for Model 5: Simpler + Mkt Value\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Variance Inflation Factors for Model 5: Simpler + Mkt Value\n\n|Variable                     |        VIF|\n|:----------------------------|----------:|\n|beds                         |   2.079469|\n|baths                        |   2.217788|\n|basements1                   |  14.222509|\n|basements2                   |   4.474744|\n|basements3                   |  15.660980|\n|basements4                   |  12.568746|\n|basements5                   |   7.734044|\n|basements6                   |   8.411127|\n|basements7                   |   3.146126|\n|basements8                   |   4.939574|\n|basements9                   |   1.146520|\n|interior2                    | 433.428669|\n|interior3                    | 511.003786|\n|interior4                    | 725.126130|\n|interior5                    |  18.777399|\n|interior6                    |   5.373677|\n|interior7                    |   6.003274|\n|exterior2                    | 107.549402|\n|exterior3                    | 280.161895|\n|exterior4                    | 430.473573|\n|exterior5                    |  28.540147|\n|exterior6                    |   3.250687|\n|exterior7                    |   7.933660|\n|liv_area                     |   5.104796|\n|`poly(age, 2)1`              |   2.469017|\n|`poly(age, 2)2`              |   2.099108|\n|dist_park_mi                 |   1.429027|\n|foodretail_1mi_count         |   9.095552|\n|dist_school_public_ft        |   1.876059|\n|mkt_value                    |   7.768525|\n|neigh_cvALLEGHENY_WEST       |   3.661075|\n|neigh_cvANDORRA              |   1.620863|\n|neigh_cvASTON_WOODBRIDGE     |   1.688578|\n|neigh_cvBARTRAM_VILLAGE      |   1.232886|\n|neigh_cvBELLA_VISTA          |   2.648721|\n|neigh_cvBELMONT              |   1.313586|\n|neigh_cvBREWERYTOWN          |   3.542230|\n|neigh_cvBRIDESBURG           |   2.820062|\n|neigh_cvBURHOLME             |   1.329891|\n|neigh_cvBUSTLETON            |   4.535277|\n|neigh_cvCARROLL_PARK         |   3.274566|\n|neigh_cvCEDAR_PARK           |   2.637660|\n|neigh_cvCEDARBROOK           |   2.787442|\n|neigh_cvCHESTNUT_HILL        |   3.339501|\n|neigh_cvCLEARVIEW            |   1.462231|\n|neigh_cvCOBBS_CREEK          |   7.549782|\n|neigh_cvDEARNLEY_PARK        |   1.180732|\n|neigh_cvDICKINSON_NARROWS    |   3.760063|\n|neigh_cvDUNLAP               |   1.414517|\n|neigh_cvEAST_FALLS           |   3.614578|\n|neigh_cvEAST_KENSINGTON      |   4.034785|\n|neigh_cvEAST_OAK_LANE        |   2.021801|\n|neigh_cvEAST_PARKSIDE        |   1.391240|\n|neigh_cvEAST_PASSYUNK        |   5.400342|\n|neigh_cvEASTWICK             |   1.408075|\n|neigh_cvELMWOOD              |   3.929218|\n|neigh_cvFAIRHILL             |   1.401604|\n|neigh_cvFAIRMOUNT            |   4.800691|\n|neigh_cvFELTONVILLE          |   3.276236|\n|neigh_cvFERN_ROCK            |   1.553823|\n|neigh_cvFISHTOWN             |   9.366947|\n|neigh_cvFITLER_SQUARE        |   1.594588|\n|neigh_cvFOX_CHASE            |   4.204728|\n|neigh_cvFRANCISVILLE         |   1.969606|\n|neigh_cvFRANKFORD            |   4.669218|\n|neigh_cvFRANKLINVILLE        |   1.801362|\n|neigh_cvGARDEN_COURT         |   1.297023|\n|neigh_cvGERMANTOWN_EAST      |   2.774685|\n|neigh_cvGERMANTOWN_MORTON    |   1.866439|\n|neigh_cvGERMANTOWN_PENN_KNOX |   1.193124|\n|neigh_cvGERMANTOWN_SOUTHWEST |   2.126860|\n|neigh_cvGERMANTOWN_WEST_CENT |   1.719776|\n|neigh_cvGERMANTOWN_WESTSIDE  |   1.304456|\n|neigh_cvGERMANY_HILL         |   1.864648|\n|neigh_cvGIRARD_ESTATES       |   4.409647|\n|neigh_cvGLENWOOD             |   1.776352|\n|neigh_cvGRADUATE_HOSPITAL    |   6.765058|\n|neigh_cvGRAYS_FERRY          |   5.620112|\n|neigh_cvGREENWICH            |   2.031752|\n|neigh_cvHADDINGTON           |   4.733530|\n|neigh_cvHARROWGATE           |   4.776293|\n|neigh_cvHARTRANFT            |   2.274215|\n|neigh_cvHAVERFORD_NORTH      |   1.238809|\n|neigh_cvHAWTHORNE            |   1.902921|\n|neigh_cvHOLMESBURG           |   6.204381|\n|neigh_cvHUNTING_PARK         |   3.088752|\n|neigh_cvJUNIATA_PARK         |   4.510213|\n|neigh_cvKINGSESSING          |   5.023030|\n|neigh_cvLAWNDALE             |   4.695615|\n|neigh_cvLEXINGTON_PARK       |   1.740326|\n|neigh_cvLOGAN                |   3.852107|\n|neigh_cvLOGAN_SQUARE         |   1.419454|\n|neigh_cvLOWER_MOYAMENSING    |   6.288348|\n|neigh_cvMANAYUNK             |   4.719119|\n|neigh_cvMANTUA               |   1.752579|\n|neigh_cvMAYFAIR              |  10.856754|\n|neigh_cvMCGUIRE              |   1.321714|\n|neigh_cvMELROSE_PARK_GARDENS |   1.542063|\n|neigh_cvMILL_CREEK           |   2.026251|\n|neigh_cvMILLBROOK            |   2.337292|\n|neigh_cvMODENA               |   3.364393|\n|neigh_cvMORRELL_PARK         |   2.998080|\n|neigh_cvMOUNT_AIRY_EAST      |   4.535431|\n|neigh_cvMOUNT_AIRY_WEST      |   3.538709|\n|neigh_cvNEWBOLD              |   3.792868|\n|neigh_cvNORMANDY_VILLAGE     |   1.200600|\n|neigh_cvNORTH_CENTRAL        |   2.671706|\n|neigh_cvNORTHERN_LIBERTIES   |   2.952639|\n|neigh_cvNORTHWOOD            |   2.019738|\n|neigh_cvOGONTZ               |   2.971028|\n|neigh_cvOLD_CITY             |   1.250390|\n|neigh_cvOLD_KENSINGTON       |   2.574254|\n|neigh_cvOLNEY                |   6.886447|\n|neigh_cvOVERBROOK            |   5.008870|\n|neigh_cvOXFORD_CIRCLE        |  11.088613|\n|neigh_cvPACKER_PARK          |   1.784012|\n|neigh_cvPARKWOOD_MANOR       |   4.605025|\n|neigh_cvPASCHALL             |   2.727475|\n|neigh_cvPASSYUNK_SQUARE      |   4.509742|\n|neigh_cvPENNSPORT            |   3.369305|\n|neigh_cvPENNYPACK            |   2.798121|\n|neigh_cvPENNYPACK_WOODS      |   1.343561|\n|neigh_cvPENROSE              |   1.609110|\n|neigh_cvPOINT_BREEZE         |  10.964432|\n|neigh_cvQUEEN_VILLAGE        |   2.691401|\n|neigh_cvRHAWNHURST           |   3.995112|\n|neigh_cvRICHMOND             |   9.510735|\n|neigh_cvRITTENHOUSE          |   3.154039|\n|neigh_cvROXBOROUGH           |   5.139763|\n|neigh_cvROXBOROUGH_PARK      |   1.387774|\n|neigh_cvSHARSWOOD            |   1.255374|\n|neigh_cvSmall_Neighborhoods  |   1.812647|\n|neigh_cvSOCIETY_HILL         |   2.522007|\n|neigh_cvSOMERTON             |   5.278331|\n|neigh_cvSOUTHWEST_SCHUYLKILL |   2.754400|\n|neigh_cvSPRING_GARDEN        |   2.034743|\n|neigh_cvSPRUCE_HILL          |   1.695846|\n|neigh_cvSTADIUM_DISTRICT     |   2.069908|\n|neigh_cvSTANTON              |   3.281597|\n|neigh_cvSTRAWBERRY_MANSION   |   3.128114|\n|neigh_cvSUMMERDALE           |   2.751373|\n|neigh_cvTACONY               |   5.249567|\n|neigh_cvTIOGA                |   2.331449|\n|neigh_cvTORRESDALE           |   2.476609|\n|neigh_cvUPPER_KENSINGTON     |   4.897645|\n|neigh_cvUPPER_ROXBOROUGH     |   3.098878|\n|neigh_cvWALNUT_HILL          |   1.689462|\n|neigh_cvWASHINGTON_SQUARE    |   2.334592|\n|neigh_cvWEST_KENSINGTON      |   2.950022|\n|neigh_cvWEST_OAK_LANE        |   7.652986|\n|neigh_cvWEST_PASSYUNK        |   4.729158|\n|neigh_cvWEST_POPLAR          |   1.220534|\n|neigh_cvWEST_POWELTON        |   1.355769|\n|neigh_cvWHITMAN              |   3.831367|\n|neigh_cvWINCHESTER_PARK      |   1.403076|\n|neigh_cvWISSAHICKON          |   2.732331|\n|neigh_cvWISSAHICKON_HILLS    |   1.455756|\n|neigh_cvWISSINOMING          |   7.039081|\n|neigh_cvWISTER               |   1.595599|\n|neigh_cvWYNNEFIELD           |   2.974526|\n|neigh_cvWYNNEFIELD_HEIGHTS   |   1.167013|\n|neigh_cvYORKTOWN             |   1.219956|\n\n\n:::\n:::\n\n",
    "supporting": [
      "midterm-final-model_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}